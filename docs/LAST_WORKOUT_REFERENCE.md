# 新功能：上次訓練參考面板

## 功能概述

當你選擇一個動作準備新增訓練紀錄時，系統現在會自動顯示「上次訓練參考」面板，讓你知道：

- ✅ 上次訓練日期
- ✅ 上次使用的重量（平均、最大）
- ✅ 上次的組數和次數
- ✅ 上次的 RPE（強度）

## 主要特點

### 1. 自動填入重量

選擇動作後，系統會自動將上次訓練的**平均重量**填入第一組，讓你不用手動輸入。

### 2. 訓練歷史統計

顯示上次訓練的詳細統計：

- **平均重量**：所有組數的平均重量
- **最大重量**：單組最大重量
- **總組數**：上次完成的總組數
- **總次數**：所有組數的總次數

### 3. 快速增重按鈕

提供四個快速操作按鈕：

- **使用 XX kg**：直接套用上次的平均重量到所有組
- **+2.5kg**：在上次平均重量基礎上增加 2.5kg
- **+5kg**：在上次平均重量基礎上增加 5kg
- **+10kg**：在上次平均重量基礎上增加 10kg

這些按鈕會自動將計算好的重量套用到**所有組數**，支援漸進式超負荷訓練。

### 4. 訓練詳情

顯示上次每一組的詳細資料：

```
Set 1: 60kg × 8次
Set 2: 60kg × 8次
Set 3: 57.5kg × 9次
```

## 使用場景

### 場景 1：從動作選單選擇

1. 進入「新增訓練」頁面
2. 從下拉選單選擇一個動作（例如：槓鈴臥推）
3. 系統自動顯示「上次訓練參考」面板
4. 重量欄位已自動填入上次的平均重量
5. 你可以：
   - 直接使用自動填入的重量
   - 點擊 +2.5kg 或 +5kg 進行漸進式增重
   - 手動調整重量

### 場景 2：從今日菜單開始訓練

1. 進入「今日菜單」頁面
2. 點擊某個動作的「開始訓練」按鈕
3. 自動跳轉到「新增訓練」頁面
4. 系統智能填入：
   - 如果菜單有設定重量 → 使用菜單重量
   - 如果菜單沒有重量 → 使用上次訓練的平均重量
5. 顯示「上次訓練參考」面板供參考

## 技術實作

### 新增的組件

- `LastWorkoutReference.tsx`：訓練歷史參考面板組件
- `LastWorkoutReference.css`：面板樣式

### 修改的文件

- `App.tsx`：
  - 新增 `lastWorkoutDetails` 狀態儲存完整的上次訓練資料
  - 修改 `handleExerciseSelect` 自動填入重量
  - 修改 `handleUsePlanItem` 智能填入重量
  - 新增 `handleApplyWeight` 和 `handleIncrementWeight` 處理快速操作

### 資料流程

```
選擇動作
  ↓
查詢訓練紀錄（排除今天）
  ↓
找到最近一次訓練
  ↓
計算平均重量
  ↓
自動填入 + 顯示參考面板
  ↓
使用者可選擇：
  - 使用自動填入的重量
  - 使用快速增重按鈕
  - 手動調整
```

## 設計亮點

### 1. 漸進式超負荷支援

提供 +2.5kg、+5kg、+10kg 三種常見的增重幅度，符合漸進式訓練原則。

### 2. 智能重量填入

- 從動作選單選擇 → 使用上次平均重量
- 從今日菜單開始 → 優先使用菜單重量，沒有則用上次平均重量

### 3. 視覺化設計

- 使用卡片式設計，清晰呈現資訊
- 統計數據使用大字體突出顯示
- 快速操作按鈕使用網格佈局，方便點擊
- 響應式設計，適配手機和桌面

### 4. 只在需要時顯示

- 只在重量訓練時顯示（有氧運動不顯示）
- 只在有歷史紀錄時顯示
- 避免資訊過載

## 未來可能的改進

1. **顯示訓練趨勢**：顯示最近 3-5 次訓練的重量變化圖表
2. **智能建議**：根據歷史資料建議下次應該使用的重量
3. **訓練筆記**：顯示上次訓練的備註，提醒特殊注意事項
4. **肌肉疲勞提示**：如果同一肌群在短時間內訓練過多次，給予提示

## 測試建議

1. 選擇一個有歷史紀錄的動作，確認面板正確顯示
2. 測試快速增重按鈕，確認重量正確套用到所有組
3. 測試從今日菜單開始訓練，確認重量智能填入
4. 測試沒有歷史紀錄的新動作，確認不會顯示面板
5. 測試有氧運動，確認不會顯示面板
