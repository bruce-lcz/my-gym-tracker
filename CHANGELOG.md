# 更新日誌

## v1.16.0

**發布日期：** 2026-01-24
**類型：** feature
**標題：** 每週訓練摘要系統與動作選擇器優化

- **每週訓練摘要系統**:
  - 新增 `WeeklySummary` 組件：自動生成「本週」與「上週」訓練摘要
  - 智能檢測機制：僅在有新訓練數據時自動重新生成摘要
  - 摘要格式化：緊湊型文字輸出，適合快速分享（例：`[01/20-01/26] 臥推 100kg(3組), 深蹲 120kg(5組)`）
  - 一鍵複製功能：方便將摘要分享至其他平台
  - 資料持久化：重用現有 `AIAnalysis` 表格，使用隱藏標記區分摘要與建議

- **動作選擇器全面升級**:
  - 新增 `ExerciseSelector` 組件：macOS/iOS 風格的下拉選單
  - 玻璃擬態設計 (Glassmorphism)：半透明背景 + 模糊效果
  - 智能搜尋：支援中英文即時過濾
  - 分類群組顯示：按身體部位自動分組（胸部、背部、肩部、下肢、手臂/核心、有氧）
  - 鍵盤導航：支援 ESC 關閉、方向鍵選擇
  - 響應式設計：桌面端自動聚焦搜尋框，手機端避免鍵盤彈出
  - 視覺回饋：選中項目藍色高亮 (#007AFF)，懸停動畫效果

- **動作資料結構優化**:
  - 新增 `part` 欄位：標記動作所屬身體部位（例：胸部、下肢）
  - 建立 `exerciseList.ts`：預定義 50+ 種常見動作的完整資訊
  - 智能資料修正：自動偵測 Google Sheets 欄位偏移問題並修正
  - 資料合併策略：Google Sheets 資料 + 本地增強資訊 + 自訂動作

- **AI Coach 改進**:
  - 修正 LLM 模型路徑：`openai/gpt-oss-120b`（解決 404 錯誤）
  - 過濾邏輯優化：歷史記錄僅顯示「建議」類型，隱藏「摘要」類型
  - 改進初始載入邏輯：優先顯示最新的建議而非摘要

- **開發體驗優化**:
  - 新增 `summaryService.ts`：封裝摘要生成邏輯與週期計算
  - 新增設計文件：`2026-01-24-weekly-summary-design.md`
  - 新增實作計畫：`2026-01-24-weekly-summary-plan.md`

---

## v1.15.0

**發布日期：** 2026-01-21
**類型：** improvement
**標題：** 菜單同步與計畫載入優化

- **菜單雲端同步優化**:
  - 新增手動「刷新」與「上傳」按鈕，提供更彈性的數據管控
  - 狀態指示器升級：顯示詳細同步狀態（同步中、成功、失敗）與最後同步時間
  - 錯誤處理：同步失敗時提供更明確的視覺回饋

- **訓練計畫載入增強**:
  - **智慧動作匹配**: 優化從菜單載入動作的邏輯，支援模糊搜尋與名稱標準化（自動忽略空白、大小寫差異）
  - **體驗優化**: 點擊「開始訓練」後自動跳轉至「新增訓練」分頁，並完整帶入目標肌群與歷史數據
  - **防呆機制**: 若找不到對應動作，會跳出提示警示，避免資料錯誤

---

## v1.14.0

**發布日期：** 2026-01-18
**類型：** feature
**標題：** AI 動作翻譯與智能肌群識別

- **Groq API 整合**: 使用 Llama 3.3 70B 模型進行智能翻譯
- **智能翻譯**: 輸入英文動作名稱，自動生成繁體中文名稱與目標肌群
- **肌群識別**: 自動識別訓練肌群（如：胸大肌、三角肌前束），支援有氧運動識別
- **互動優化**: 新增生成按鈕動畫，優化自訂動作表單體驗

## v1.13.0

**發布日期：** 2026-01-18
**類型：** feature
**標題：** 健身菜單系統與雲端同步

- **健身菜單 Tab**: 新增專屬頁面管理每日訓練計畫，支援完成狀態追蹤
- **預設套餐**: 內建上半身、下半身、全身循環、核心有氧等 4 種專業課表
- **自訂與同步**: 可建立自訂套餐並自動同步至 Google Sheets (WorkoutPackages 分頁)
- **雙向同步**: 支援本地 (LocalStorage) 與雲端雙向備份，離線也能使用
- **JSON 匯入**: 支援快速匯入外部 JSON 格式菜單

## v1.12.0

**發布日期：** 2026-01-18
**類型：** improvement
**標題：** 雙用戶權限與安全系統升級

- **雙用戶模式**: 升級為 Bruce / Linda 雙用戶獨立登入系統
- **獨立密碼**: 支援 VITE_BRUCE_PASSWORD 與 VITE_LINDA_PASSWORD 環境變數
- **自動識別**: 登入時根據密碼自動識別使用者身分並切換對應主題
- **安全性優化**: 移除單一通用密碼，提升帳戶安全性

---

## v1.11.0 - 2026-01-11 🔒

### ✨ 新功能

- **簡易密碼保護 (Simple Password Protection)**
  - 新增前端密碼驗證頁面 (`Login.tsx`)
  - 使用者需輸入正確密碼 (`VITE_ACCESS_PASSWORD`) 才能進入應用程式
  - 阻擋未授權的一般訪問，提升個人隱私
  - 登入狀態維持 (Session Persistence)

### 🛡️ 安全性更新

- **雙層驗證架構**
  - **第一層 (前端)**: 密碼鎖定 UI，防止直接瀏覽
  - **第二層 (後端)**: Google Apps Script Token + Email 白名單，防止惡意 API 呼叫
  - 更新 `SECURITY.md` 提供詳細的安全建議與密碼更換指南

### 🔧 配置變更

- 新增環境變數 `VITE_ACCESS_PASSWORD`
- 更新 `.env.example` 範本

---

## v1.10.0 - 2026-01-10 🤖

### ✨ 重大新功能

#### 🤖 AI 助理健身教練

- **OpenAI 整合**
  - 整合 GPT-5-nano 模型進行智慧訓練分析
  - 基於訓練頻率、肌群平衡、RPE 強度生成個性化建議
  - 結構化 Markdown 輸出，包含訓練頻率分析、肌群平衡評估、強度評估
  - 提供 3-5 點具體改進建議與短中期目標

- **分析歷史系統**
  - 儲存並讀取過去的 AI 分析記錄
  - 自動同步至 Google Sheets `AI_Analysis` 分頁
  - 支援時間戳記與使用者篩選
  - 點擊歷史記錄可快速查看過去建議

- **互動式 UI**
  - 訓練數據摘要儀表板（總訓練次數、天數、肌群分佈）
  - 載入動畫與錯誤處理
  - 雲端同步狀態指示器
  - 支援 GitHub Flavored Markdown 渲染

#### 💪 互動式肌肉視覺化

- **3D 人體模型**
  - 使用 `react-body-highlighter` 實現前後面身體視圖
  - 可切換正面 / 背面顯示

- **智慧肌群映射系統**
  - 完整的中文至英文肌群名稱轉換
  - 支援 26+ 種英文肌群標識符
  - 100+ 種中文肌群名稱變化智慧映射
  - 模糊匹配提升靈活性

- **點擊互動**
  - 點擊肌群查看訓練頻率
  - 顯示所有針對該肌群的動作
  - 相關動作模式統計

- **使用者主題配色**
  - Bruce: 綠色 / 自然色調漸層
  - Linda: 梅納德 / 大地色調漸層
  - 4 級強度漸層（低至高）

### 🎨 統計儀表板改進

- **高對比度配色**
  - Bruce: 鮮明綠藍混合色系 (#2E8B57, #20B2AA, #9ACD32 等)
  - Linda: 溫暖橘棕混合色系 (#8D6E63, #FF7043, #FFA726 等)

- **響應式圖表**
  - 根據螢幕尺寸自動調整圖表高度（手機 250px，桌面 300px）
  - 圓餅圖優化：僅顯示 > 5% 的百分比標籤
  - 移除多餘的標籤線
  - 增加圖例高度與字型大小

- **肌肉視覺化整合**
  - 在儀表板頂部新增肌力狀態熱圖區塊

### 🛠️ 後端與 API 更新

#### Google Apps Script

- 新增 `AI_Analysis` 分頁自動建立功能
- `saveAIAnalysis()`: 儲存 AI 分析內容（使用者、時間戳、唯一 ID）
- `getAIAnalyses()`: 取得特定使用者的所有歷史分析
- 改善錯誤處理與驗證機制

#### 前端 API

- `saveAIAnalysis()`: POST 端點儲存 AI 分析
- `fetchAIAnalysis()`: GET 端點取得分析歷史
- 新增 `AIAnalysis` 型別定義

### 📦 新增依賴套件

- `openai@^6.15.0` - OpenAI API 客戶端
- `react-body-highlighter@^2.0.5` - 互動式 3D 人體模型
- `react-markdown@^10.1.0` - Markdown 渲染
- `remark-gfm@^4.0.1` - GitHub Flavored Markdown 支援

### 📁 新增檔案

- `src/AICoach.tsx` (512 行) - AI 教練主組件
- `src/components/MuscleVisualizer.tsx` (224 行) - 互動式肌肉視覺化
- `src/muscleMapping.ts` (181 行) - 肌群名稱映射工具

### 🔐 環境設定需求

使用 AI 教練功能需在 `.env.local` 設定：

```env
VITE_OPENAI_API_KEY=your-openai-api-key-here
```

---

## v1.9.0 - 2026-01-07 🎯

### ✨ 新功能

- **自訂動作同步至 Google Sheets**
  - 新增自訂動作時自動同步至後端 Google Sheets
  - 新增 `createExercise` API 端點支援 POST 請求
  - 自動建立 Exercises 分頁（如不存在）
  - 重複動作名稱檢測機制
  - 同步失敗時提供 localStorage 備援機制
  - 改善錯誤處理與使用者回饋訊息

### 🎨 訓練紀錄 UI 大幅改進

- **日期分組顯示**
  - 訓練紀錄依日期自動分組，提升可讀性
  - 新增固定式日期標題（sticky headers）搭配日曆圖示
  - 採用現代卡片式佈局取代傳統表格

- **卡片式設計**
  - 每筆訓練紀錄顯示為獨立卡片，資訊層次清晰
  - 組數顯示改用編號標籤 (#1, #2...) 與數值分離
  - 備註與下次目標移至底部 footer 區塊
  - 加入懸停動畫效果與視覺回饋

- **響應式優化**
  - 手機版自動切換為單欄佈局
  - 觸控友善的按鈕與間距設計
  - 改善小螢幕上的資訊呈現

### 🛠️ 技術修復

- **訓練組數順序修正**
  - 修正統計儀表板中訓練組數顯示順序
  - 今日訓練顯示最新組數優先
  - 歷史紀錄按時間正序排列

---

## v1.8.0 - 2026-01-07 🎨

### 🎨 視覺與體驗重塑 (UI/UX Redesign)

- **UI 全面重設計**
  - 重新設計使用者介面，提供更現代化的視覺體驗
  - 優化 Linda 主題，細緻化色彩與元件樣式
  - 新增流暢的動畫效果，提升操作回饋感
  - 強化響應式設計，確保在不同裝置上都有最佳顯示效果

### 🛠️ 技術修復與優化

- **CORS 問題修復**
  - 解決跨來源資源共用 (CORS) 問題
  - 改用 `text/plain` 內容類型傳輸，確保與後端通訊穩定
  - 更新相關文件說明

- **應用程式邏輯修正**
  - 統一動作類型 (Exercise Type) 的處理邏輯，確保資料一致性

---

## v1.7.0 - 2025-12-25 🎄

### ✨ 新功能

- **動態動作資料載入**
  - 從 Google Sheets 的「Exercises」分頁動態載入動作資料
  - 新增 `getExercises()` API 端點，支援即時同步動作清單
  - 實作三層資料優先級：Google Sheets → localStorage 自訂動作 → 預設動作
  - 新增完整的錯誤處理與日誌記錄機制

- **輪播勵志語錄**
  - 首頁勵志語錄每 10 秒自動輪播
  - 使用 React hooks 實現流暢的切換效果
  - 提升使用者參與度與訓練動力

### 🎨 視覺與主題優化

- **CSS 主題系統重構**
  - 大幅優化 CSS 程式碼，減少 47% 檔案大小 (566 行刪除, 294 行新增)
  - 整合重複的 CSS 規則，提升維護性
  - 改善深色模式實作，更好的變數使用
  - 優化 Bruce 和 Linda 使用者專屬主題變數

### 🛠️ 技術改進

- **API 與配置優化**
  - 新增 Vite proxy 配置，改善 Google Apps Script API 連線
  - 實作智慧 URL 處理：支援絕對路徑 (production) 和相對路徑 (dev)
  - 強化型別安全：修復 `s.weight.includes` TypeError
  - 更新 TypeScript 配置，提升型別檢查能力
  - 改善錯誤處理與 proxy 連線管理

### 📚 文件更新

- 新增完整的 Google Sheets 設定指南 (`docs/GOOGLE_SHEET_SETUP.md`)
- 更新 AppScript 文件，包含 Exercises 分頁設定說明
- 提供詳細的欄位結構與配置步驟

### 🐛 錯誤修復

- 修復 `TypeError: s.weight.includes is not a function` 問題
- 解決 CORS 相關問題，改善 proxy 配置
- 修正多個型別安全問題

---

## v1.6.0 - 2025-12-24

### 🔧 配置與整合改進

- **CORS 問題解決**
  - 修復本地開發環境與 Google Apps Script 的 CORS 錯誤
  - 優化 `Access-Control-Allow-Origin` 標頭設定
  - 改善客戶端與伺服器端的通訊配置

- **Proxy 配置優化**
  - 解決「Invalid URL」錯誤
  - 調整 Vite 開發伺服器的 proxy 設定
  - 確保本地開發與生產環境的一致性

### 🛠️ 技術改進

- 更新依賴套件版本
- 改善錯誤處理機制
- 優化開發環境配置

---

## v1.5.0 - 2025-12-24

### 📚 文件與專案管理

- **專案文件更新**
  - 更新 v1.4.0 版本的完整文件
  - 整理專案結構說明
  - 改善 README 與設定指南

### 🔄 分支管理

- 同步 dev 分支與 GitHub
- 合併主分支的最新變更
- 優化 Git 工作流程

---

## v1.4.0 - 2025-12-23

### ✨ 新功能

- **互動式統計儀表板**
  - 點擊「最常練的動作」圖表可選擇動作並自動滾動至詳細區塊
  - 懸停時顯示豐富的提示框，包含最近訓練組數 (例如: "50kg@12")
  - 新增 `ExerciseDetail` 組件，展示：
    - 個人紀錄 (PR) 與總訓練量統計
    - 最大重量進度折線圖
    - 可滾動的歷史訓練紀錄列表

- **有氧運動支援**
  - 新增動作類型區分：重量訓練 vs 有氧運動
  - 有氧運動專屬輸入欄位：速度 (kph)、坡度 (%)、時間 (min)
  - 智慧資料映射：將有氧數據儲存於現有 Google Sheet 結構
  - 歷史紀錄自動偵測並格式化有氧訓練顯示 (例如: "30 min (Spd:9 Inc:1)")

### 🎨 視覺與主題優化

- **Linda 主題更新**
  - 將粉色主題替換為溫暖的「梅納德」(Maillard) 色調
  - 採用大地色系：棕色、米色、拿鐵色
  - 圖表配色動態適應使用者主題 (Bruce: 綠色系 / Linda: 大地色系)

- **提示框增強**
  - 深色背景提升可讀性與對比度
  - 更清晰的資訊層次與視覺引導

### 🛠️ 技術改進

- 擴展 `SetData` 類型以支援有氧運動欄位 (incline, speed, time)
- 新增 `Exercise` 類型屬性以區分訓練類型
- 優化圖表互動邏輯與自動滾動體驗
- 改善資料處理與顯示邏輯的模組化

---

## v1.3.0 - 2025-12-20

### ✨ 新功能

- **全新側邊欄導覽系統**
  - 響應式側邊欄設計,支援電腦端收合與手機端抽屜式選單
  - 整合多個功能入口:統計儀表板、新增訓練、訓練紀錄
  - 全新「版本紀錄」抽屜,直接從原始碼載入最新更新資訊

- **動態啟發語錄**
  - 首頁頂部隨機切換激勵人心的健身語錄
  - 增加訓練時的沉浸感與動力

### 🎨 視覺與交互優化

- **佈局重構**: 從單頁 Tab 切換進化為側邊欄導覽,提升擴展性
- **動態圖標**: 更多 Lucide 圖標應用,強化視覺導引
- **主題色調微調**: 優化深色模式下的對比度與層次感

---

## v1.2.0 - 2025-12-19

### 📊 統計儀表板 (Dashboard)

- **數據可視化整合**
  - 整合 [Recharts](https://recharts.org/) 繪圖庫
  - **訓練部位分佈圖**: 圓餅圖呈現各肌群訓練比例
  - **熱門動作排行榜**: 橫向柱狀圖顯示最常練習的 Top 5 動作
  - **範例數據模式**: 提供 Demo Data 按鈕,方便無數據時快速預覽效果

### 🛠️ 技術改進

- **模組化組件**: 拆分 Dashboard 組件,保持代碼整潔
- **自動化數據處理**: 根據訓練紀錄自動計算肌群分佈與頻率

---

## v1.1.0 - 2025-12-17

### ✨ 新功能

- **版本紀錄系統**
  - 新增「版本紀錄」Tab,可以記錄和管理應用程式的版本更新
  - 支援四種類型的更新:新功能、錯誤修復、優化改進、重大變更
  - 可新增多個變更項目,記錄詳細的更新內容
  - 支援刪除版本紀錄
  - 使用 localStorage 在本地保存版本紀錄
  - 預設包含兩個示例版本紀錄,展示功能用法

- **Tab 導航系統**
  - 新增三個主要 Tab:新增訓練、訓練紀錄、版本紀錄
  - 美觀的 Tab 切換動畫效果
  - 響應式設計,在手機上自動調整為縱向排列

- **圖標系統升級**
  - 整合 [Lucide React](https://lucide.dev/) 圖標庫
  - 替換所有 emoji 為專業的 SVG 圖標
  - 為所有按鈕添加對應的圖標

### 🎨 視覺改進

- 標題加入健身圖標
- 所有按鈕統一使用 flexbox 布局,圖標與文字對齊更美觀
- Tab 導航加入漸層背景和活動狀態指示
- 版本紀錄卡片設計

### 📱 響應式優化

- Tab 導航在手機上自動適配
- 版本紀錄在小螢幕上優化排版
- 圖標大小在不同螢幕尺寸下自動調整

### 🌙 深色模式

- 為所有新增的 UI 元素添加深色模式支援
- Tab 導航在深色模式下的配色
- 版本紀錄卡片在深色模式下的樣式
- 類型標籤在深色模式下的顏色調整

### 🛠️ 技術改進

- 新增 `ReleaseNote` 類型定義
- 更新 TypeScript 類型系統
- 優化組件狀態管理
- 改善代碼組織結構

## v1.0.0 - 2025-12-17

### ✨ 初始發布

- 基本訓練記錄功能
- Google Sheets 整合
- 深色/淺色主題切換
- 自訂動作功能
- 響應式設計
